<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastAPI è¯¦ç»†ä½¿ç”¨æ•™ç¨‹</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <style>
        :root {
            --primary: #009688;
            --primary-dark: #00796b;
            --secondary: #607d8b;
            --accent: #ff4081;
            --light: #f5f7fa;
            --dark: #263238;
            --code-bg: #2d2d2d;
            --success: #4caf50;
            --warning: #ff9800;
            --error: #f44336;
            --border: #e0e0e0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            gap: 30px;
        }

        /* ä¾§è¾¹æ å¯¼èˆª */
        .sidebar {
            width: 280px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            position: sticky;
            top: 20px;
            height: fit-content;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .sidebar h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 8px;
        }

        .nav-link {
            display: block;
            padding: 12px 15px;
            color: var(--dark);
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-link:hover {
            background: rgba(0, 150, 136, 0.1);
            color: var(--primary);
            transform: translateX(5px);
        }

        .nav-link.active {
            background: var(--primary);
            color: white;
        }

        /* ä¸»è¦å†…å®¹åŒº */
        .main-content {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }

        .header h1 {
            font-size: 2.8rem;
            color: var(--primary);
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            color: var(--secondary);
            font-size: 1.2rem;
        }

        /* ç« èŠ‚æ ·å¼ */
        .chapter {
            margin-bottom: 50px;
            scroll-margin-top: 20px;
        }

        .chapter-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
        }

        .chapter-number {
            background: var(--primary);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .chapter-title {
            font-size: 1.8rem;
            color: var(--dark);
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .section-title {
            font-size: 1.4rem;
            color: var(--primary-dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: "â–¶";
            color: var(--accent);
            font-size: 0.8em;
        }

        .section-content {
            color: #555;
        }

        .section-content p {
            margin-bottom: 15px;
        }

        .section-content ul, .section-content ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .section-content li {
            margin-bottom: 8px;
        }

        /* ä»£ç å—æ ·å¼ */
        .code-block {
            background: var(--code-bg);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
        }

        .code-header {
            background: #1e1e1e;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #404040;
        }

        .code-language {
            color: #ccc;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .copy-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s ease;
        }

        .copy-btn:hover {
            background: var(--primary-dark);
        }

        pre[class*="language-"] {
            margin: 0;
            padding: 20px;
            background: var(--code-bg) !important;
            border-radius: 0 0 10px 10px;
        }

        /* ç‰¹è‰²å¡ç‰‡ */
        .feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .feature-card h3 {
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid var(--border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .feature-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .feature-icon {
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .module-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }

        .module-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .module-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
        }

        .module-table tr:hover {
            background: rgba(0, 150, 136, 0.05);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 992px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                position: static;
            }
            
            .main-content {
                padding: 25px;
            }
        }

        @media (max-width: 576px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .chapter-title {
                font-size: 1.5rem;
            }
            
            .section {
                padding: 15px;
            }
        }

        /* é¡µè„š */
        .footer {
            text-align: center;
            padding: 30px;
            color: white;
            margin-top: 40px;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .footer-link {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .footer-link:hover {
            opacity: 1;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ä¾§è¾¹æ å¯¼èˆª -->
        <aside class="sidebar">
            <h2>ğŸ“š æ•™ç¨‹ç›®å½•</h2>
            <ul class="nav-menu">
                <li class="nav-item"><a href="#intro" class="nav-link active">1. FastAPI ç®€ä»‹</a></li>
                <li class="nav-item"><a href="#installation" class="nav-link">2. å®‰è£…ä¸ç¯å¢ƒé…ç½®</a></li>
                <li class="nav-item"><a href="#first-app" class="nav-link">3. ç¬¬ä¸€ä¸ª FastAPI åº”ç”¨</a></li>
                <li class="nav-item"><a href="#routing" class="nav-link">4. è·¯ç”±ä¸è¯·æ±‚å¤„ç†</a></li>
                <li class="nav-item"><a href="#parameters" class="nav-link">5. å‚æ•°å¤„ç†</a></li>
                <li class="nav-item"><a href="#request-body" class="nav-link">6. è¯·æ±‚ä½“ä¸ Pydantic</a></li>
                <li class="nav-item"><a href="#response-model" class="nav-link">7. å“åº”æ¨¡å‹</a></li>
                <li class="nav-item"><a href="#dependency" class="nav-link">8. ä¾èµ–æ³¨å…¥ç³»ç»Ÿ</a></li>
                <li class="nav-item"><a href="#middleware" class="nav-link">9. ä¸­é—´ä»¶</a></li>
                <li class="nav-item"><a href="#exception" class="nav-link">10. å¼‚å¸¸å¤„ç†</a></li>
                <li class="nav-item"><a href="#testing" class="nav-link">11. æµ‹è¯•</a></li>
                <li class="nav-item"><a href="#deployment" class="nav-link">12. éƒ¨ç½²</a></li>
                <li class="nav-item"><a href="#modules" class="nav-link">13. æ ¸å¿ƒæ¨¡å—è¯¦è§£</a></li>
            </ul>
        </aside>

        <!-- ä¸»è¦å†…å®¹åŒº -->
        <main class="main-content">
            <header class="header">
                <h1>FastAPI è¯¦ç»†ä½¿ç”¨æ•™ç¨‹</h1>
                <p>ç°ä»£ã€å¿«é€Ÿï¼ˆé«˜æ€§èƒ½ï¼‰çš„ Python Web æ¡†æ¶ï¼Œç”¨äºæ„å»º API</p>
            </header>

            <!-- ç¬¬1ç« ï¼šFastAPI ç®€ä»‹ -->
            <section id="intro" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">1</div>
                    <h2 class="chapter-title">FastAPI ç®€ä»‹</h2>
                </div>
                
                <div class="section">
                    <h3 class="section-title">ä»€ä¹ˆæ˜¯ FastAPIï¼Ÿ</h3>
                    <div class="section-content">
                        <p>FastAPI æ˜¯ä¸€ä¸ªç°ä»£çš„ã€å¿«é€Ÿçš„ï¼ˆé«˜æ€§èƒ½ï¼‰Python Web æ¡†æ¶ï¼Œç”¨äºæ„å»º APIã€‚å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
                        <ul>
                            <li>åŸºäºæ ‡å‡† Python ç±»å‹æç¤º</li>
                            <li>è‡ªåŠ¨ç”Ÿæˆäº¤äº’å¼ API æ–‡æ¡£ï¼ˆSwagger UI å’Œ ReDocï¼‰</li>
                            <li>é«˜æ€§èƒ½ï¼Œå¯ä¸ NodeJS å’Œ Go ç›¸åª²ç¾</li>
                            <li>å†…ç½®æ•°æ®éªŒè¯ã€åºåˆ—åŒ–å’Œæ–‡æ¡£ç”Ÿæˆ</li>
                            <li>æ”¯æŒå¼‚æ­¥/ç­‰å¾…è¯­æ³•</li>
                            <li>ç¬¦åˆ OpenAPI å’Œ JSON Schema æ ‡å‡†</li>
                        </ul>
                    </div>
                </div>

                <div class="feature-grid">
                    <div class="feature-item">
                        <div class="feature-icon">âš¡</div>
                        <h4>é«˜æ€§èƒ½</h4>
                        <p>åŸºäº Starlette å’Œ Pydanticï¼Œæ€§èƒ½å“è¶Šï¼Œæ”¯æŒå¼‚æ­¥ç¼–ç¨‹ã€‚</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ğŸ“</div>
                        <h4>è‡ªåŠ¨æ–‡æ¡£</h4>
                        <p>è‡ªåŠ¨ç”Ÿæˆäº¤äº’å¼ API æ–‡æ¡£ï¼Œæ”¯æŒ Swagger UI å’Œ ReDocã€‚</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ğŸ”§</div>
                        <h4>ç±»å‹å®‰å…¨</h4>
                        <p>åŸºäº Python ç±»å‹æç¤ºï¼Œæä¾›ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥ã€‚</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">ğŸ›¡ï¸</div>
                        <h4>æ•°æ®éªŒè¯</h4>
                        <p>å†…ç½®æ•°æ®éªŒè¯ï¼ŒåŸºäº Pydantic æ¨¡å‹ã€‚</p>
                    </div>
                </div>
            </section>

            <!-- ç¬¬2ç« ï¼šå®‰è£…ä¸ç¯å¢ƒé…ç½® -->
            <section id="installation" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">2</div>
                    <h2 class="chapter-title">å®‰è£…ä¸ç¯å¢ƒé…ç½®</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">å®‰è£… FastAPI</h3>
                    <div class="section-content">
                        <p>ä½¿ç”¨ pip å®‰è£… FastAPI å’Œ Uvicornï¼ˆASGI æœåŠ¡å™¨ï¼‰ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">bash</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
                            <pre><code class="language-bash"># å®‰è£… FastAPI å’Œ Uvicorn
pip install fastapi uvicorn

# å®‰è£…æ‰€æœ‰å¯é€‰ä¾èµ–
pip install "fastapi[all]"

# æˆ–è€…ä½¿ç”¨ uvï¼ˆæ¨èï¼‰
uv add fastapi uvicorn</code></pre>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">è™šæ‹Ÿç¯å¢ƒé…ç½®</h3>
                    <div class="section-content">
                        <p>æ¨èä½¿ç”¨è™šæ‹Ÿç¯å¢ƒéš”ç¦»é¡¹ç›®ä¾èµ–ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">bash</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
                            <pre><code class="language-bash"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# Windows æ¿€æ´»
venv\Scripts\activate

# macOS/Linux æ¿€æ´»
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install fastapi uvicorn</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬3ç« ï¼šç¬¬ä¸€ä¸ª FastAPI åº”ç”¨ -->
            <section id="first-app" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">3</div>
                    <h2 class="chapter-title">ç¬¬ä¸€ä¸ª FastAPI åº”ç”¨</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">åˆ›å»ºåŸºæœ¬åº”ç”¨</h3>
                    <div class="section-content">
                        <p>åˆ›å»ºä¸€ä¸ªç®€å•çš„ FastAPI åº”ç”¨ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
                            <pre><code class="language-python"># main.py
from fastapi import FastAPI
from typing import Optional

# åˆ›å»º FastAPI å®ä¾‹
app = FastAPI(
    title="My API",
    description="è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ª FastAPI åº”ç”¨",
    version="1.0.0"
)

# å®šä¹‰æ ¹è·¯ç”±
@app.get("/")
async def root():
    return {"message": "Hello FastAPI!"}

# å¸¦è·¯å¾„å‚æ•°çš„è·¯ç”±
@app.get("/items/{item_id}")
async def read_item(item_id: int, q: Optional[str] = None):
    return {"item_id": item_id, "q": q}

# è¿è¡Œåº”ç”¨ï¼ˆåœ¨ç»ˆç«¯æ‰§è¡Œï¼šuvicorn main:app --reloadï¼‰
if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)</code></pre>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">è¿è¡Œåº”ç”¨</h3>
                    <div class="section-content">
                        <p>ä½¿ç”¨ Uvicorn è¿è¡Œåº”ç”¨ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">bash</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
                            <pre><code class="language-bash"># å¼€å‘æ¨¡å¼ï¼ˆæ”¯æŒçƒ­é‡è½½ï¼‰
uvicorn main:app --reload

# æŒ‡å®šä¸»æœºå’Œç«¯å£
uvicorn main:app --host 0.0.0.0 --port 8000 --reload

# ç”Ÿäº§æ¨¡å¼ï¼ˆå…³é—­é‡è½½ï¼‰
uvicorn main:app --host 0.0.0.0 --port 8000</code></pre>
                        </div>
                        <p>è®¿é—®ä»¥ä¸‹åœ°å€ï¼š</p>
                        <ul>
                            <li>API æ–‡æ¡£ï¼š<a href="http://localhost:8000/docs" target="_blank">http://localhost:8000/docs</a></li>
                            <li>Redoc æ–‡æ¡£ï¼š<a href="http://localhost:8000/redoc" target="_blank">http://localhost:8000/redoc</a></li>
                            <li>OpenAPI è§„èŒƒï¼š<a href="http://localhost:8000/openapi.json" target="_blank">http://localhost:8000/openapi.json</a></li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- ç¬¬4ç« ï¼šè·¯ç”±ä¸è¯·æ±‚å¤„ç† -->
            <section id="routing" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">4</div>
                    <h2 class="chapter-title">è·¯ç”±ä¸è¯·æ±‚å¤„ç†</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">HTTP æ–¹æ³•è£…é¥°å™¨</h3>
                    <div class="section-content">
                        <p>FastAPI æ”¯æŒæ‰€æœ‰ HTTP æ–¹æ³•ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
                            <pre><code class="language-python">from fastapi import FastAPI

app = FastAPI()

# GET è¯·æ±‚
@app.get("/items/")
async def read_items():
    return [{"item": "Foo"}, {"item": "Bar"}]

# POST è¯·æ±‚
@app.post("/items/")
async def create_item(item: dict):
    return {"item": item}

# PUT è¯·æ±‚
@app.put("/items/{item_id}")
async def update_item(item_id: int, item: dict):
    return {"item_id": item_id, "item": item}

# DELETE è¯·æ±‚
@app.delete("/items/{item_id}")
async def delete_item(item_id: int):
    return {"deleted": item_id}

# PATCH è¯·æ±‚
@app.patch("/items/{item_id}")
async def patch_item(item_id: int, item: dict):
    return {"item_id": item_id, "updated_fields": item}</code></pre>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">è·¯ç”±å‰ç¼€å’Œæ ‡ç­¾</h3>
                    <div class="section-content">
                        <p>ä½¿ç”¨ APIRouter ç»„ç»‡è·¯ç”±ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import APIRouter, FastAPI

# åˆ›å»ºè·¯ç”±å™¨
router = APIRouter(
    prefix="/api/v1",
    tags=["items"],
    responses={404: {"description": "Not found"}}
)

@router.get("/items/")
async def read_items():
    return [{"item": "Foo"}, {"item": "Bar"}]

@router.get("/items/{item_id}")
async def read_item(item_id: int):
    return {"item_id": item_id}

# ä¸»åº”ç”¨
app = FastAPI()

# åŒ…å«è·¯ç”±å™¨
app.include_router(router)

# å¦ä¸€ä¸ªè·¯ç”±å™¨ç¤ºä¾‹
user_router = APIRouter(prefix="/users", tags=["users"])

@user_router.get("/")
async def read_users():
    return [{"username": "john"}, {"username": "jane"}]

app.include_router(user_router)</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬5ç« ï¼šå‚æ•°å¤„ç† -->
            <section id="parameters" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">5</div>
                    <h2 class="chapter-title">å‚æ•°å¤„ç†</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">è·¯å¾„å‚æ•°</h3>
                    <div class="section-content">
                        <p>è·¯å¾„å‚æ•°é€šè¿‡ URL è·¯å¾„ä¼ é€’ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import FastAPI
from enum import Enum

app = FastAPI()

class ModelName(str, Enum):
    alexnet = "alexnet"
    resnet = "resnet"
    lenet = "lenet"

# åŸºæœ¬è·¯å¾„å‚æ•°
@app.get("/items/{item_id}")
async def read_item(item_id: int):
    return {"item_id": item_id}

# æšä¸¾ç±»å‹è·¯å¾„å‚æ•°
@app.get("/models/{model_name}")
async def get_model(model_name: ModelName):
    if model_name is ModelName.alexnet:
        return {"model_name": model_name, "message": "Deep Learning FTW!"}
    if model_name.value == "lenet":
        return {"model_name": model_name, "message": "LeCNN all the images"}
    return {"model_name": model_name, "message": "Have some residuals"}

# è·¯å¾„è½¬æ¢å™¨
@app.get("/files/{file_path:path}")
async def read_file(file_path: str):
    return {"file_path": file_path}</code></pre>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">æŸ¥è¯¢å‚æ•°</h3>
                    <div class="section-content">
                        <p>æŸ¥è¯¢å‚æ•°é€šè¿‡ URL æŸ¥è¯¢å­—ç¬¦ä¸²ä¼ é€’ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import FastAPI
from typing import Optional, List

app = FastAPI()

# å¿…éœ€å’Œå¯é€‰æŸ¥è¯¢å‚æ•°
@app.get("/items/")
async def read_items(
    skip: int = 0,          # å¿…éœ€å‚æ•°ï¼ˆæ²¡æœ‰é»˜è®¤å€¼ï¼‰
    limit: int = 10,        # å¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º 10
    q: Optional[str] = None # å¯é€‰å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º None
):
    items = [{"item": "Foo"}, {"item": "Bar"}]
    result = items[skip: skip + limit]
    if q:
        result = [item for item in result if q in item["item"]]
    return result

# å¸ƒå°”ç±»å‹æŸ¥è¯¢å‚æ•°
@app.get("/items/bool/")
async def read_items_bool(active: bool = True):
    return {"active": active}

# åˆ—è¡¨ç±»å‹æŸ¥è¯¢å‚æ•°
@app.get("/items/list/")
async def read_items_list(q: Optional[List[str]] = None):
    return {"q": q}

# å‚æ•°åˆ«å
@app.get("/items/alias/")
async def read_items_alias(item_query: Optional[str] = None, q: str = None):
    if item_query:
        return {"item_query": item_query}
    if q:
        return {"q": q}
    return {"message": "No query provided"}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬6ç« ï¼šè¯·æ±‚ä½“ä¸ Pydantic -->
            <section id="request-body" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">6</div>
                    <h2 class="chapter-title">è¯·æ±‚ä½“ä¸ Pydantic</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">Pydantic æ¨¡å‹</h3>
                    <div class="section-content">
                        <p>ä½¿ç”¨ Pydantic æ¨¡å‹å®šä¹‰æ•°æ®ç»“æ„ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import FastAPI
from pydantic import BaseModel, Field, EmailStr
from typing import Optional, List
from datetime import datetime

app = FastAPI()

# åŸºæœ¬æ¨¡å‹
class Item(BaseModel):
    name: str
    description: Optional[str] = None
    price: float
    tax: Optional[float] = None

# å¸¦å­—æ®µéªŒè¯çš„æ¨¡å‹
class User(BaseModel):
    username: str = Field(..., min_length=3, max_length=50)
    email: EmailStr
    age: int = Field(..., gt=0, lt=150)
    tags: List[str] = []
    created_at: datetime = Field(default_factory=datetime.now)

# åµŒå¥—æ¨¡å‹
class Address(BaseModel):
    street: str
    city: str
    country: str

class Company(BaseModel):
    name: str
    address: Address
    employees: List[User]

# ç»§æ‰¿æ¨¡å‹
class ItemBase(BaseModel):
    name: str
    description: Optional[str] = None

class ItemCreate(ItemBase):
    price: float

class ItemUpdate(ItemBase):
    price: Optional[float] = None
    tax: Optional[float] = None

class ItemResponse(ItemBase):
    id: int
    price: float
    tax: Optional[float] = None
    
    class Config:
        orm_mode = True  # æ”¯æŒ ORM å¯¹è±¡è½¬æ¢</code></pre>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">è¯·æ±‚ä½“å¤„ç†</h3>
                    <div class="section-content">
                        <p>å¤„ç†ä¸åŒç±»å‹çš„è¯·æ±‚ä½“ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import FastAPI, Body
from pydantic import BaseModel
from typing import Optional

app = FastAPI()

class Item(BaseModel):
    name: str
    description: Optional[str] = None
    price: float
    tax: Optional[float] = None

# å•ä¸€è¯·æ±‚ä½“
@app.post("/items/")
async def create_item(item: Item):
    return item

# å¤šä¸ªè¯·æ±‚ä½“å‚æ•°
@app.put("/items/{item_id}")
async def update_item(
    item_id: int,
    item: Item,
    user: dict,
    importance: int = Body(...)
):
    return {
        "item_id": item_id,
        "item": item,
        "user": user,
        "importance": importance
    }

# åµŒå…¥å•ä¸ªè¯·æ±‚ä½“å‚æ•°
@app.post("/items/embed/")
async def create_embedded_item(
    item: Item = Body(..., embed=True)
):
    return item

# æ··åˆè·¯å¾„ã€æŸ¥è¯¢å’Œè¯·æ±‚ä½“å‚æ•°
@app.post("/items/mixed/{item_id}")
async def mixed_params(
    item_id: int,
    item: Item,
    q: Optional[str] = None,
    short: bool = False
):
    result = {"item_id": item_id, **item.dict()}
    if q:
        result.update({"q": q})
    if not short:
        result.update({
            "description": "This is a long description..."
        })
    return result</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬7ç« ï¼šå“åº”æ¨¡å‹ -->
            <section id="response-model" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">7</div>
                    <h2 class="chapter-title">å“åº”æ¨¡å‹</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">å“åº”æ¨¡å‹é…ç½®</h3>
                    <div class="section-content">
                        <p>æ§åˆ¶ API å“åº”çš„æ•°æ®å’Œæ ¼å¼ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import FastAPI
from pydantic import BaseModel, EmailStr
from typing import Optional, List

app = FastAPI()

class UserBase(BaseModel):
    username: str
    email: EmailStr
    full_name: Optional[str] = None

class UserCreate(UserBase):
    password: str

class UserResponse(UserBase):
    id: int
    is_active: bool = True
    
    class Config:
        orm_mode = True

# æŒ‡å®šå“åº”æ¨¡å‹
@app.post("/users/", response_model=UserResponse)
async def create_user(user: UserCreate):
    # æ¨¡æ‹Ÿæ•°æ®åº“ä¿å­˜
    db_user = {
        "id": 1,
        "username": user.username,
        "email": user.email,
        "full_name": user.full_name,
        "is_active": True
    }
    return db_user

# æ’é™¤å“åº”å­—æ®µ
@app.get("/users/me", response_model=UserResponse)
async def read_user_me():
    return {
        "id": 1,
        "username": "john",
        "email": "john@example.com",
        "full_name": "John Doe",
        "password": "secret",  # ä¼šè¢«æ’é™¤
        "is_active": True
    }

# åˆ—è¡¨å“åº”
@app.get("/users/", response_model=List[UserResponse])
async def read_users():
    return [
        {
            "id": 1,
            "username": "john",
            "email": "john@example.com",
            "full_name": "John Doe",
            "is_active": True
        },
        {
            "id": 2,
            "username": "jane",
            "email": "jane@example.com",
            "full_name": "Jane Smith",
            "is_active": True
        }
    ]

# å“åº”çŠ¶æ€ç 
from fastapi import status

@app.post("/items/", response_model=Item, status_code=status.HTTP_201_CREATED)
async def create_item(item: Item):
    return item</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬8ç« ï¼šä¾èµ–æ³¨å…¥ç³»ç»Ÿ -->
            <section id="dependency" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">8</div>
                    <h2 class="chapter-title">ä¾èµ–æ³¨å…¥ç³»ç»Ÿ</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">ä¾èµ–é¡¹åŸºç¡€</h3>
                    <div class="section-content">
                        <p>FastAPI çš„å¼ºå¤§ä¾èµ–æ³¨å…¥ç³»ç»Ÿï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import FastAPI, Depends, Header, HTTPException
from typing import Optional

app = FastAPI()

# ç®€å•ä¾èµ–é¡¹
async def common_parameters(
    q: Optional[str] = None,
    skip: int = 0,
    limit: int = 100
):
    return {"q": q, "skip": skip, "limit": limit}

@app.get("/items/")
async def read_items(commons: dict = Depends(common_parameters)):
    return commons

# ç±»ä½œä¸ºä¾èµ–é¡¹
class QueryParams:
    def __init__(
        self,
        q: Optional[str] = None,
        skip: int = 0,
        limit: int = 100
    ):
        self.q = q
        self.skip = skip
        self.limit = limit

@app.get("/items/class/")
async def read_items_class(params: QueryParams = Depends()):
    return params

# å¸¦éªŒè¯çš„ä¾èµ–é¡¹
async def verify_token(x_token: str = Header(...)):
    if x_token != "fake-super-secret-token":
        raise HTTPException(status_code=400, detail="X-Token header invalid")
    return x_token

async def verify_key(x_key: str = Header(...)):
    if x_key != "fake-super-secret-key":
        raise HTTPException(status_code=400, detail="X-Key header invalid")
    return x_key

@app.get("/items/auth/", dependencies=[Depends(verify_token), Depends(verify_key)])
async def read_items_auth():
    return [{"item": "Foo"}, {"item": "Bar"}]

# ä¾èµ–é¡¹åµŒå¥—
def get_db():
    # æ¨¡æ‹Ÿæ•°æ®åº“è¿æ¥
    db = "database connection"
    try:
        yield db
    finally:
        # å…³é—­æ•°æ®åº“è¿æ¥
        print("Closing database connection")

def get_current_user(db: str = Depends(get_db)):
    # æ¨¡æ‹Ÿä»æ•°æ®åº“è·å–ç”¨æˆ·
    return {"username": "john", "db": db}

@app.get("/users/me/")
async def read_current_user(user: dict = Depends(get_current_user)):
    return user</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬9ç« ï¼šä¸­é—´ä»¶ -->
            <section id="middleware" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">9</div>
                    <h2 class="chapter-title">ä¸­é—´ä»¶</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">è‡ªå®šä¹‰ä¸­é—´ä»¶</h3>
                    <div class="section-content">
                        <p>åˆ›å»ºå’Œé…ç½®ä¸­é—´ä»¶ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import FastAPI, Request
import time
from starlette.middleware.base import BaseHTTPMiddleware
from starlette.responses import Response

app = FastAPI()

# ç®€å•ä¸­é—´ä»¶
@app.middleware("http")
async def add_process_time_header(request: Request, call_next):
    start_time = time.time()
    response = await call_next(request)
    process_time = time.time() - start_time
    response.headers["X-Process-Time"] = str(process_time)
    return response

# CORS ä¸­é—´ä»¶
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000", "https://example.com"],
    allow_credentials=True,
    allow_methods=["GET", "POST", "PUT", "DELETE", "OPTIONS"],
    allow_headers=["*"],
    expose_headers=["X-Process-Time"]
)

# è‡ªå®šä¹‰ä¸­é—´ä»¶ç±»
class LoggingMiddleware(BaseHTTPMiddleware):
    async def dispatch(self, request: Request, call_next):
        # è¯·æ±‚å‰å¤„ç†
        print(f"Request: {request.method} {request.url}")
        
        # å¤„ç†è¯·æ±‚
        response = await call_next(request)
        
        # å“åº”åå¤„ç†
        print(f"Response status: {response.status_code}")
        return response

app.add_middleware(LoggingMiddleware)

# è®¤è¯ä¸­é—´ä»¶
@app.middleware("http")
async def authenticate_request(request: Request, call_next):
    auth_header = request.headers.get("Authorization")
    
    if auth_header:
        # éªŒè¯ä»¤ç‰Œ
        token = auth_header.replace("Bearer ", "")
        if token == "valid-token":
            # å°†ç”¨æˆ·ä¿¡æ¯æ·»åŠ åˆ°è¯·æ±‚çŠ¶æ€
            request.state.user = {"id": 1, "username": "john"}
        else:
            from fastapi.responses import JSONResponse
            return JSONResponse(
                status_code=401,
                content={"detail": "Invalid token"}
            )
    else:
        request.state.user = None
    
    response = await call_next(request)
    return response

@app.get("/protected/")
async def protected_route(request: Request):
    user = request.state.user
    if not user:
        return {"message": "Unauthorized"}
    return {"message": f"Welcome {user['username']}"}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬10ç« ï¼šå¼‚å¸¸å¤„ç† -->
            <section id="exception" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">10</div>
                    <h2 class="chapter-title">å¼‚å¸¸å¤„ç†</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å™¨</h3>
                    <div class="section-content">
                        <p>å¤„ç†å’Œè‡ªå®šä¹‰å¼‚å¸¸ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python">from fastapi import FastAPI, HTTPException, Request
from fastapi.responses import JSONResponse
from fastapi.exceptions import RequestValidationError
from starlette.exceptions import HTTPException as StarletteHTTPException

app = FastAPI()

# è‡ªå®šä¹‰å¼‚å¸¸ç±»
class CustomException(Exception):
    def __init__(self, message: str, code: int = 400):
        self.message = message
        self.code = code

# è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å™¨
@app.exception_handler(CustomException)
async def custom_exception_handler(request: Request, exc: CustomException):
    return JSONResponse(
        status_code=exc.code,
        content={
            "message": exc.message,
            "error_code": "CUSTOM_ERROR",
            "request_id": request.headers.get("X-Request-ID", "unknown")
        }
    )

# HTTPException å¤„ç†å™¨
@app.exception_handler(HTTPException)
async def http_exception_handler(request: Request, exc: HTTPException):
    return JSONResponse(
        status_code=exc.status_code,
        content={
            "detail": exc.detail,
            "status_code": exc.status_code
        }
    )

# éªŒè¯é”™è¯¯å¤„ç†å™¨
@app.exception_handler(RequestValidationError)
async def validation_exception_handler(request: Request, exc: RequestValidationError):
    errors = []
    for error in exc.errors():
        errors.append({
            "loc": error["loc"],
            "msg": error["msg"],
            "type": error["type"]
        })
    
    return JSONResponse(
        status_code=422,
        content={
            "detail": "Validation error",
            "errors": errors
        }
    )

# å…¨å±€å¼‚å¸¸å¤„ç†å™¨
@app.exception_handler(Exception)
async def global_exception_handler(request: Request, exc: Exception):
    return JSONResponse(
        status_code=500,
        content={
            "detail": "Internal server error",
            "error": str(exc)
        }
    )

# ä½¿ç”¨ç¤ºä¾‹
@app.get("/items/{item_id}")
async def read_item(item_id: int):
    if item_id < 1:
        raise HTTPException(
            status_code=400,
            detail="Item ID must be positive",
            headers={"X-Error": "Invalid ID"}
        )
    
    if item_id > 100:
        raise CustomException(
            message="Item ID too large",
            code=400
        )
    
    return {"item_id": item_id}

# é¢„å®šä¹‰çš„ HTTP å¼‚å¸¸
from fastapi import status

@app.post("/items/")
async def create_item(item: dict):
    if not item:
        raise HTTPException(
            status_code=status.HTTP_400_BAD_REQUEST,
            detail="Item data is required"
        )
    
    # æ¨¡æ‹Ÿåˆ›å»ºå¤±è´¥
    if item.get("name") == "invalid":
        raise HTTPException(
            status_code=status.HTTP_409_CONFLICT,
            detail="Item already exists"
        )
    
    return {"id": 1, **item}</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬11ç« ï¼šæµ‹è¯• -->
            <section id="testing" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">11</div>
                    <h2 class="chapter-title">æµ‹è¯•</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">ä½¿ç”¨ TestClient æµ‹è¯•</h3>
                    <div class="section-content">
                        <p>ç¼–å†™å’Œè¿è¡Œ FastAPI åº”ç”¨çš„æµ‹è¯•ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">python</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-python"># test_main.py
from fastapi.testclient import TestClient
from main import app
import pytest

client = TestClient(app)

def test_read_root():
    response = client.get("/")
    assert response.status_code == 200
    assert response.json() == {"message": "Hello FastAPI!"}

def test_read_item():
    response = client.get("/items/42")
    assert response.status_code == 200
    assert response.json() == {"item_id": 42, "q": None}

def test_read_item_with_query():
    response = client.get("/items/42?q=test")
    assert response.status_code == 200
    assert response.json() == {"item_id": 42, "q": "test"}

def test_create_item():
    item_data = {"name": "Test Item", "price": 9.99}
    response = client.post("/items/", json=item_data)
    assert response.status_code == 200
    data = response.json()
    assert data["name"] == "Test Item"
    assert data["price"] == 9.99

def test_invalid_item():
    response = client.get("/items/-1")
    assert response.status_code == 400
    assert "detail" in response.json()

def test_authentication():
    # æµ‹è¯•éœ€è¦è®¤è¯çš„ç«¯ç‚¹
    headers = {"Authorization": "Bearer valid-token"}
    response = client.get("/protected/", headers=headers)
    assert response.status_code == 200
    
    # æµ‹è¯•æ— æ•ˆä»¤ç‰Œ
    headers = {"Authorization": "Bearer invalid-token"}
    response = client.get("/protected/", headers=headers)
    assert response.status_code == 401

# å¼‚æ­¥æµ‹è¯•
@pytest.mark.asyncio
async def test_async_endpoint():
    from httpx import AsyncClient
    
    async with AsyncClient(app=app, base_url="http://test") as ac:
        response = await ac.get("/items/1")
        assert response.status_code == 200

# æµ‹è¯•ä¾èµ–æ³¨å…¥
def test_dependency_override():
    from main import app
    from fastapi import Depends
    
    def override_dependency():
        return {"q": "overridden", "skip": 5, "limit": 50}
    
    app.dependency_overrides[common_parameters] = override_dependency
    
    response = client.get("/items/")
    assert response.status_code == 200
    assert response.json() == {"q": "overridden", "skip": 5, "limit": 50}
    
    # æ¸…ç†è¦†ç›–
    app.dependency_overrides.clear()

# è¿è¡Œæµ‹è¯•
if __name__ == "__main__":
    import sys
    import unittest
    
    # ä½¿ç”¨ unittest è¿è¡Œæµ‹è¯•
    loader = unittest.TestLoader()
    suite = loader.loadTestsFromModule(sys.modules[__name__])
    runner = unittest.TextTestRunner(verbosity=2)
    runner.run(suite)</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬12ç« ï¼šéƒ¨ç½² -->
            <section id="deployment" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">12</div>
                    <h2 class="chapter-title">éƒ¨ç½²</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">éƒ¨ç½²é€‰é¡¹</h3>
                    <div class="section-content">
                        <p>å„ç§éƒ¨ç½² FastAPI åº”ç”¨çš„æ–¹å¼ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">bash</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-bash"># Docker éƒ¨ç½²
# Dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]

# docker-compose.yml
version: '3.8'
services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:password@db:5432/db
    depends_on:
      - db
  
  db:
    image: postgres:13
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
      POSTGRES_DB: db

# ä½¿ç”¨ Gunicorn éƒ¨ç½²ï¼ˆå¤šè¿›ç¨‹ï¼‰
# å®‰è£… Gunicorn
pip install gunicorn uvloop httptools

# ä½¿ç”¨ Uvicorn worker è¿è¡Œ
gunicorn main:app --workers 4 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000

# ç”Ÿäº§ç¯å¢ƒé…ç½®
gunicorn main:app \
  --workers 4 \
  --worker-class uvicorn.workers.UvicornWorker \
  --bind 0.0.0.0:8000 \
  --access-logfile - \
  --error-logfile - \
  --timeout 120 \
  --keep-alive 5

# ä½¿ç”¨ Nginx åå‘ä»£ç†
# nginx.conf é…ç½®
server {
    listen 80;
    server_name api.example.com;
    
    location / {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # é™æ€æ–‡ä»¶
    location /static {
        alias /app/static;
    }
}

# ä½¿ç”¨ Supervisor ç®¡ç†è¿›ç¨‹
# /etc/supervisor/conf.d/fastapi.conf
[program:fastapi]
command=/app/venv/bin/gunicorn main:app --workers 4 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
directory=/app
user=www-data
autostart=true
autorestart=true
stderr_logfile=/var/log/fastapi.err.log
stdout_logfile=/var/log/fastapi.out.log

# äº‘å¹³å°éƒ¨ç½²ï¼ˆä»¥ Heroku ä¸ºä¾‹ï¼‰
# Procfile
web: uvicorn main:app --host=0.0.0.0 --port=${PORT:-8000}

# requirements.txt
fastapi==0.104.1
uvicorn[standard]==0.24.0
gunicorn==21.2.0

# runtime.txt
python-3.9.16</code></pre>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¬¬13ç« ï¼šæ ¸å¿ƒæ¨¡å—è¯¦è§£ -->
            <section id="modules" class="chapter">
                <div class="chapter-header">
                    <div class="chapter-number">13</div>
                    <h2 class="chapter-title">æ ¸å¿ƒæ¨¡å—è¯¦è§£</h2>
                </div>

                <div class="section">
                    <h3 class="section-title">FastAPI æ ¸å¿ƒæ¨¡å—</h3>
                    <div class="section-content">
                        <p>FastAPI çš„ä¸»è¦æ¨¡å—åŠå…¶åŠŸèƒ½ï¼š</p>
                        
                        <table class="module-table">
                            <thead>
                                <tr>
                                    <th>æ¨¡å—</th>
                                    <th>å¯¼å…¥è·¯å¾„</th>
                                    <th>ä¸»è¦åŠŸèƒ½</th>
                                    <th>å¸¸ç”¨ç±»/å‡½æ•°</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>FastAPI</strong></td>
                                    <td><code>from fastapi import FastAPI</code></td>
                                    <td>ä¸»åº”ç”¨ç±»ï¼Œåˆ›å»º FastAPI åº”ç”¨å®ä¾‹</td>
                                    <td><code>FastAPI()</code>, <code>app.include_router()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>APIRouter</strong></td>
                                    <td><code>from fastapi import APIRouter</code></td>
                                    <td>è·¯ç”±ç»„ç»‡ï¼Œæ¨¡å—åŒ– API ç«¯ç‚¹</td>
                                    <td><code>APIRouter()</code>, <code>router.get()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Request</strong></td>
                                    <td><code>from fastapi import Request</code></td>
                                    <td>HTTP è¯·æ±‚å¯¹è±¡ï¼ŒåŒ…å«è¯·æ±‚ä¿¡æ¯</td>
                                    <td><code>request.headers</code>, <code>request.body()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Response</strong></td>
                                    <td><code>from fastapi import Response</code></td>
                                    <td>HTTP å“åº”å¯¹è±¡ï¼Œæ§åˆ¶å“åº”</td>
                                    <td><code>Response()</code>, <code>JSONResponse()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Depends</strong></td>
                                    <td><code>from fastapi import Depends</code></td>
                                    <td>ä¾èµ–æ³¨å…¥ç³»ç»Ÿ</td>
                                    <td><code>Depends()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>HTTPException</strong></td>
                                    <td><code>from fastapi import HTTPException</code></td>
                                    <td>HTTP å¼‚å¸¸å¤„ç†</td>
                                    <td><code>HTTPException()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>status</strong></td>
                                    <td><code>from fastapi import status</code></td>
                                    <td>HTTP çŠ¶æ€ç å¸¸é‡</td>
                                    <td><code>status.HTTP_200_OK</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Query</strong></td>
                                    <td><code>from fastapi import Query</code></td>
                                    <td>æŸ¥è¯¢å‚æ•°éªŒè¯</td>
                                    <td><code>Query()</code>, <code>Query(None)</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Path</strong></td>
                                    <td><code>from fastapi import Path</code></td>
                                    <td>è·¯å¾„å‚æ•°éªŒè¯</td>
                                    <td><code>Path()</code>, <code>Path(..., gt=0)</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Body</strong></td>
                                    <td><code>from fastapi import Body</code></td>
                                    <td>è¯·æ±‚ä½“éªŒè¯</td>
                                    <td><code>Body()</code>, <code>Body(..., embed=True)</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Form</strong></td>
                                    <td><code>from fastapi import Form</code></td>
                                    <td>è¡¨å•æ•°æ®å¤„ç†</td>
                                    <td><code>Form()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>File</strong></td>
                                    <td><code>from fastapi import File</code></td>
                                    <td>æ–‡ä»¶ä¸Šä¼ å¤„ç†</td>
                                    <td><code>File()</code>, <code>UploadFile</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Cookie</strong></td>
                                    <td><code>from fastapi import Cookie</code></td>
                                    <td>Cookie å‚æ•°å¤„ç†</td>
                                    <td><code>Cookie()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Header</strong></td>
                                    <td><code>from fastapi import Header</code></td>
                                    <td>è¯·æ±‚å¤´å¤„ç†</td>
                                    <td><code>Header()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>Security</strong></td>
                                    <td><code>from fastapi.security import *</code></td>
                                    <td>å®‰å…¨è®¤è¯æ–¹æ¡ˆ</td>
                                    <td><code>HTTPBasic</code>, <code>OAuth2PasswordBearer</code></td>
                                </tr>
                                <tr>
                                    <td><strong>BackgroundTasks</strong></td>
                                    <td><code>from fastapi import BackgroundTasks</code></td>
                                    <td>åå°ä»»åŠ¡å¤„ç†</td>
                                    <td><code>BackgroundTasks()</code></td>
                                </tr>
                                <tr>
                                    <td><strong>WebSocket</strong></td>
                                    <td><code>from fastapi import WebSocket</code></td>
                                    <td>WebSocket æ”¯æŒ</td>
                                    <td><code>WebSocket()</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="section">
                    <h3 class="section-title">å®Œæ•´é¡¹ç›®ç»“æ„ç¤ºä¾‹</h3>
                    <div class="section-content">
                        <p>æ ‡å‡†çš„ FastAPI é¡¹ç›®ç»“æ„ï¼š</p>
                        <div class="code-block">
                            <div class="code-header">
                                <span class="code-language">text</span>
                                <button class="copy-btn">å¤åˆ¶ä»£ç </button>
                            </div>
<pre><code class="language-text">my_fastapi_project/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py              # ä¸»åº”ç”¨æ–‡ä»¶
â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py       # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ security.py     # å®‰å…¨ç›¸å…³
â”‚   â”‚   â””â”€â”€ exceptions.py   # è‡ªå®šä¹‰å¼‚å¸¸
â”‚   â”œâ”€â”€ api/               # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ deps.py        # ä¾èµ–é¡¹
â”‚   â”‚   â”œâ”€â”€ routers/       # è·¯ç”±æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ items.py   # ç‰©å“è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ users.py   # ç”¨æˆ·è·¯ç”±
â”‚   â”‚   â””â”€â”€ endpoints/     # ç«¯ç‚¹æ¨¡å—
â”‚   â”œâ”€â”€ models/            # Pydantic æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ item.py
â”‚   â”‚   â””â”€â”€ user.py
â”‚   â”œâ”€â”€ schemas/           # SQLAlchemy æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ item.py
â”‚   â”‚   â””â”€â”€ user.py
â”‚   â”œâ”€â”€ crud/             # CRUD æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ item.py
â”‚   â”‚   â””â”€â”€ user.py
â”‚   â”œâ”€â”€ db/               # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ session.py    # æ•°æ®åº“ä¼šè¯
â”‚   â”‚   â””â”€â”€ base.py       # åŸºç±»æ¨¡å‹
â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ helpers.py
â”œâ”€â”€ tests/                # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py      # æµ‹è¯•é…ç½®
â”‚   â”œâ”€â”€ test_items.py
â”‚   â””â”€â”€ test_users.py
â”œâ”€â”€ alembic/             # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ versions/
â”‚   â””â”€â”€ env.py
â”œâ”€â”€ static/              # é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ css/
â”‚   â””â”€â”€ images/
â”œâ”€â”€ templates/           # æ¨¡æ¿æ–‡ä»¶
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ requirements.txt     # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ requirements-dev.txt # å¼€å‘ä¾èµ–
â”œâ”€â”€ Dockerfile          # Docker é…ç½®
â”œâ”€â”€ docker-compose.yml  # Docker Compose
â”œâ”€â”€ .env.example        # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md</code></pre>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <footer class="footer">
        <p>Â© 2024 FastAPI è¯¦ç»†ä½¿ç”¨æ•™ç¨‹ | åŸºäº FastAPI 0.104.1</p>
        <div class="footer-links">
            <a href="https://fastapi.tiangolo.com/" class="footer-link" target="_blank">å®˜æ–¹æ–‡æ¡£</a>
            <a href="https://github.com/tiangolo/fastapi" class="footer-link" target="_blank">GitHub</a>
            <a href="https://fastapi.tiangolo.com/zh/" class="footer-link" target="_blank">ä¸­æ–‡æ–‡æ¡£</a>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script>
        // å¯¼èˆªæ¿€æ´»çŠ¶æ€
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.chapter');
            
            // å¤åˆ¶ä»£ç åŠŸèƒ½
            document.querySelectorAll('.copy-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const codeBlock = this.closest('.code-block').querySelector('code');
                    const textArea = document.createElement('textarea');
                    textArea.value = codeBlock.textContent;
                    document.body.appendChild(textArea);
                    textArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textArea);
                    
                    // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
                    const originalText = this.textContent;
                    this.textContent = 'å·²å¤åˆ¶!';
                    this.style.background = '#4CAF50';
                    
                    setTimeout(() => {
                        this.textContent = originalText;
                        this.style.background = '';
                    }, 2000);
                });
            });
            
            // æ»šåŠ¨ç›‘å¬
            function updateActiveNavLink() {
                let currentSection = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - 100;
                    const sectionHeight = section.clientHeight;
                    const scrollPosition = window.pageYOffset;
                    
                    if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                        currentSection = section.id;
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${currentSection}`) {
                        link.classList.add('active');
                    }
                });
            }
            
            window.addEventListener('scroll', updateActiveNavLink);
            updateActiveNavLink(); // åˆå§‹è°ƒç”¨
            
            // å¹³æ»‘æ»šåŠ¨
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        // æ›´æ–°å¯¼èˆªæ¿€æ´»çŠ¶æ€
                        navLinks.forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                    }
                });
            });
            
            // ä»£ç é«˜äº®
            if (typeof Prism !== 'undefined') {
                Prism.highlightAll();
            }
        });
    </script>
</body>
</html>
